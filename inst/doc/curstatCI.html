<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Piet Groeneboom and Kim Hendrickx" />

<meta name="date" content="2017-07-19" />

<title>Confidence intervals with current status data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Confidence intervals with current status data</h1>
<h4 class="author"><em>Piet Groeneboom and Kim Hendrickx</em></h4>
<h4 class="date"><em>2017-07-19</em></h4>



<p>In the current status model, a positive variable of interest <span class="math inline">\(X\)</span> with distribution function <span class="math inline">\(F_0\)</span> is not observed directly. A censoring variable <span class="math inline">\(T \sim G\)</span> is observed instead together with the indicator <span class="math inline">\(\Delta=(X \le T)\)</span>. <em>curstatCI</em> provides functions to estimate the distribution function <span class="math inline">\(F_0\)</span> and to construct pointswise confidence intervals around <span class="math inline">\(F_0(t)\)</span> based on an observed sample <span class="math inline">\((T_1, \Delta_1),\ldots, (T_n, \Delta_n)\)</span> of size <span class="math inline">\(n\)</span> from the observable random vector <span class="math inline">\((T, \Delta)\)</span>.</p>
<p>To illustrate the usage of the functions provided in the <em>curstatCI</em> package we consider a sample <span class="math inline">\((X_1,\ldots,X_n)\)</span> of size <span class="math inline">\(n=1000\)</span> from the truncated exponential distribution on <span class="math inline">\([0,2]\)</span> with distribution function <span class="math inline">\(F_0(t)=(1-\exp(-t))/(1-\exp(-2)\)</span> if <span class="math inline">\(t \in [0,2]\)</span>. The observation points <span class="math inline">\((T_1,\ldots,T_n)\)</span> are sampled from a uniform distribution on <span class="math inline">\([0,2]\)</span>. This data setting is also considered in the simulation section of <span class="citation">Groeneboom and Hendrickx (2017)</span>. The R-code to generate the observable random vector <span class="math inline">\((t_1,\delta_1), \ldots, (t_n, \delta_n)\)</span> is given below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)

n&lt;-<span class="dv">1000</span>
t&lt;-<span class="kw">rep</span>(<span class="ot">NA</span>, n)
delta&lt;-<span class="kw">rep</span>(<span class="ot">NA</span>, n)

for(i in (<span class="dv">1</span>:n) ){
  x&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)
  y&lt;--<span class="kw">log</span>(<span class="dv">1</span>-(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="dv">2</span>))*x)
  t[i]&lt;-<span class="dv">2</span>*<span class="kw">runif</span>(<span class="dv">1</span>);
  if(y&lt;=t[i]){ delta[i]&lt;-<span class="dv">1</span>}
  else{delta[i]&lt;-<span class="dv">0</span>}}</code></pre></div>
<div id="the-nonparametric-maximum-likelihood-estimator-mle" class="section level2">
<h2>The nonparametric maximum likelihood estimator (MLE)</h2>
<p>The MLE <span class="math inline">\(F_n\)</span> of <span class="math inline">\(F_0\)</span> is defined as the maximizer of the log likelihood given by (up to a constant not depending on <span class="math inline">\(F\)</span>) <span class="math display">\[ \sum_{i=1}^n \Delta_i\log F(T_i) +  (1-\Delta_i)\log(1-F(T_i)),\]</span> over all possible distribution functions <span class="math inline">\(F\)</span>. As can be seen from its structure, the log likelihood only depends on the value that <span class="math inline">\(F\)</span> takes at the observed time points <span class="math inline">\(T_i\)</span>. The values in between are irrelevant as long as <span class="math inline">\(F\)</span> is increasing. The MLE <span class="math inline">\(F_n\)</span> is a step function which can be characterized by the left derivative of the greatest convex minorant of the cumulative sumdiagran consisting of the points <span class="math inline">\(P_0=(0,0)\)</span> and <span class="math display">\[P_i=\left(\sum_{j=1}^i w_j,\sum_{j=1}^i f_{1j}\right),\,i=1,\dots,m,\]</span></p>
<p>where the <span class="math inline">\(w_j\)</span> are weights, given by the number of observations at point <span class="math inline">\(T_{(j)}\)</span>, assuming that <span class="math inline">\(T_{(1)}&lt;\dots&lt;T_{(m)}\)</span> (<span class="math inline">\(m\)</span> being the number of different observations in the sample) are the order statistics of the sample <span class="math inline">\((T_1,\Delta_1),\dots,(T_n,\Delta_n)\)</span> and where <span class="math inline">\(f_{1j}\)</span> is the number of <span class="math inline">\(\Delta_k\)</span> equal to one at the <span class="math inline">\(j\)</span>th order statistic of the sample. When no ties are present in the data, <span class="math inline">\(w_j=1, m=n\)</span> and <span class="math inline">\(f_{1j}=\Delta_{(j)}\)</span>, where <span class="math inline">\(\Delta_{(j)}\)</span> corresponds to <span class="math inline">\(T_{(j)}\)</span>.</p>
<p>The function <em>ComputeMLE</em> in the package curstatCI computes the values of the MLE at the distinct jump points of the stepwise MLE. The current status data needs to be formatted as follows. The first column contains the observations <span class="math inline">\(t_{(1)}&lt;\dots&lt;t_{(m)}\)</span> in ascending order. The second and third columns contain the variables <span class="math inline">\(f_{1j}\)</span> and <span class="math inline">\(w_j\)</span> corresponding to <span class="math inline">\(t_{(j)}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A&lt;-<span class="kw">cbind</span>(t[<span class="kw">order</span>(t)], delta[<span class="kw">order</span>(t)], <span class="kw">rep</span>(<span class="dv">1</span>,n))
<span class="kw">head</span>(A)</code></pre></div>
<pre><code>##              [,1] [,2] [,3]
## [1,] 0.0007901406    0    1
## [2,] 0.0064286250    0    1
## [3,] 0.0075551583    0    1
## [4,] 0.0121238651    0    1
## [5,] 0.0150197768    0    1
## [6,] 0.0179643347    0    1</code></pre>
<p>The function <em>ComputeMLE</em> returns the jump points and corresponding values of the MLE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp)
<span class="kw">library</span>(curstatCI)

mle&lt;-<span class="kw">ComputeMLE</span>(<span class="dt">data=</span>A)
mle</code></pre></div>
<pre><code>##             x        mle
## 1  0.00000000 0.00000000
## 2  0.04461921 0.05405405
## 3  0.12463964 0.15000000
## 4  0.18832966 0.18181818
## 5  0.21623244 0.21428571
## 6  0.24208302 0.25000000
## 7  0.25054101 0.30555556
## 8  0.32536475 0.38461538
## 9  0.34771374 0.38888889
## 10 0.39735814 0.45454545
## 11 0.55754520 0.50000000
## 12 0.63327266 0.51515152
## 13 0.70567068 0.54838710
## 14 0.74357757 0.61363636
## 15 0.82979603 0.66666667
## 16 0.83427289 0.69230769
## 17 0.90577147 0.69902913
## 18 1.13136189 0.75000000
## 19 1.14422337 0.81967213
## 20 1.38870142 0.85714286
## 21 1.40659256 0.90000000
## 22 1.48428796 0.92307692
## 23 1.55291452 0.97297297
## 24 1.77735579 0.98666667
## 25 1.91620524 1.00000000</code></pre>
<p>The number of jump points in the simulated data example equals 24. The MLE is zero at all points smaller than the first jump point 0.04461921 and one at all points larger than or equal than the last jump point 1.91620524. A picture of the step function <span class="math inline">\(F_n\)</span> is given below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mle$x, mle$mle,<span class="dt">type=</span><span class="st">'s'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="the-smoothed-maximum-likelihood-estimator-smle" class="section level2">
<h2>The smoothed maximum likelihood estimator (SMLE)</h2>
<p>Starting from the nonparametric MLE <span class="math inline">\(F_n\)</span>, a smooth estimator <span class="math inline">\(\tilde{F}_{nh}\)</span> of the distribution function <span class="math inline">\(F_0\)</span> can be obtained by smoothing the MLE <span class="math inline">\(F_n\)</span> using a kernel function <span class="math inline">\(K\)</span> and bandwidth <span class="math inline">\(h&gt;0\)</span>. We use the triweight kernel defined by <span class="math display">\[ K(t)=\frac{35}{32}\left(1-t^2\right)^31_{[-1,1]}(t).\]</span> The SMLE is next defined by <span class="math display">\[ \tilde F_{nh}(t)=\int\mathbb K\left(\frac{t-x}{h}\right)\,d F_n(x), \]</span> where <span class="math display">\[\mathbb K(t)=\int_{-\infty}^t K(x)\,dx.\]</span> The function <em>ComputeSMLE</em> computes the values of the SMLE in the points x based on a prespecified bandwidth choice <span class="math inline">\(h\)</span>. A user-specified bandwidth vector bw of size  is used for each point in the vetor x. A data-driven bandwidth choice for each point in x is returned by the function <em>ComputeBW</em> which is described later.</p>
<p>For our simulated data set, a picture of the SMLE <span class="math inline">\(\tilde F_{nh}(t)\)</span> using a bandwidth <span class="math inline">\(h=2n^{-1/5}\)</span>, evaluated in the points <span class="math inline">\(t=0.02,0.04,\ldots,1.98\)</span> together with the true distribution function <span class="math inline">\(F_0\)</span> is obtained as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid&lt;-<span class="kw">seq</span>(<span class="fl">0.02</span>,<span class="fl">1.98</span>, <span class="fl">0.02</span>)
bw&lt;-<span class="kw">rep</span>(<span class="dv">2</span>*n^-<span class="fl">0.2</span>,<span class="kw">length</span>(grid))
smle&lt;-<span class="kw">ComputeSMLE</span>(<span class="dt">data=</span>A, <span class="dt">x=</span>grid, <span class="dt">bw=</span>bw)
<span class="kw">plot</span>(grid, smle,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, (<span class="dv">1</span>-<span class="kw">exp</span>(-grid))/(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="fl">2.0</span>)), <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="pointwise-confidence-intervals-around-the-smle-using-a-data-driven-pointwise-bandwidth-vector" class="section level2">
<h2>Pointwise confidence intervals around the SMLE using a data-driven pointwise bandwidth vector</h2>
<p>The nonparametric bootstrap procedure, which consists of resampling (with replacement) the <span class="math inline">\((T_i,\Delta_i)\)</span> from the original sample is consistent for generating the limiting distribution of the SMLE <span class="math inline">\(\tilde F_{nh}(t)\)</span> under current status data. (see <span class="citation">Groeneboom and Hendrickx (2017)</span>). This implies that valid pointwise confidence intervals for the distribution function <span class="math inline">\(F_0(t)\)</span> can be constructed using a bootstrap sample <span class="math inline">\((T_1^*,\Delta_1^*),\ldots (T_n^*,\Delta_n^*)\)</span>. The <span class="math inline">\(1-\alpha\)</span> bootstrap confidence intervals generated by the function <em>ComputeConfIntervals</em> are given by <span class="math display">\[ \left[\tilde F_{nh}(t)-Q_{1-\alpha/2}^*(t)\sqrt{S_{nh}(t)}, \tilde F_{nh}(t)-Q_{\alpha/2}^*(t)\sqrt{S_{nh}(t)}\right],\]</span> where <span class="math inline">\(Q_{\alpha}^*(t)\)</span> is the <span class="math inline">\(\alpha\)</span>th quantile of <span class="math inline">\(B\)</span> values of <span class="math inline">\(W_{nh}^*(t)\)</span> defined by, <span class="math display">\[W_{nh}^*(t)=\left\{\tilde F_{nh}^*(t)-\tilde F_{nh}(t)\right\}/\sqrt{S_{nh}^*(t)},\]</span> where <span class="math inline">\(\tilde F_{nh}^*(t)\)</span> is the SMLE in the bootstrap sample and <span class="math inline">\(S_{nh}(t)\)</span> is given by: <span class="math display">\[S_{nh}(t)=\frac1{hn^{2}}\sum_{i=1}^n K\left(\frac{t-T_i}h\right)^2\left(\Delta_i-F_n(T_i)\right)^2.\]</span> <span class="math inline">\(S_{nh}^*(t)\)</span> is the bootstrap analogue of <span class="math inline">\(S_{nh}(t)\)</span> obtained by replacing <span class="math inline">\((T_i,\Delta_i)\)</span> in the expression above by <span class="math inline">\((T_i^*,\Delta_i^*)\)</span>. The number of bootstrap samples <span class="math inline">\(B\)</span> used by the function <em>ComputeSMLE</em> equals <span class="math inline">\(B=1000\)</span>.</p>
<p>The bandwidth for estimating the SMLE <span class="math inline">\(\tilde F_{nh}\)</span> at point <span class="math inline">\(t\)</span>, obtained by minimizing the pointwise Mean Squared Error using the subsampling pricinciple in combination with undersmoothing is given by the function <em>ComputeBW</em>. To obtain an approximation to the optimal bandwidth minimizing the pointwise MSE, <span class="math inline">\(1000\)</span> bootstrap subsamples of size <span class="math inline">\(m=o(n)\)</span> are generated from the original sample using the subsampling principle and <span class="math inline">\(c_{t, opt}\)</span> is selected as the minimizer of <span class="math display">\[ \sum_{b=1}^{1000}\left\{\tilde F_{m,cm^{-1/5}}^b(t) - \tilde F_{n,c_0n^{-1/5}}(t) \right\}^2,\]</span> where <span class="math inline">\(\tilde F_{n,c_0n^{-1/5}}\)</span> is the SMLE in the original sample of size <span class="math inline">\(n\)</span> using an initial bandwidth <span class="math inline">\(c_0n^{-1/5}\)</span>. The bandwidth used for estimating the SMLE is next given by <span class="math inline">\(h=c_{t,opt}n^{-1/4}\)</span>.</p>
<p>When the bandwidth <span class="math inline">\(h\)</span> is small, it can happen that no time points are observed within the interval <span class="math inline">\([t-h, t+h]\)</span>. As a consequence the estimate of the variance <span class="math inline">\(S_{nh}(t)\)</span> is zero and the Studentized Confidence intervals are unsatisfactory. If this happens, the function <em>ComputeConfIntervals</em> returns the classical <span class="math inline">\(1-\alpha\)</span> confidence intervalsgiven by: <span class="math display">\[ \left[\tilde F_{nh}(t)-Z_{1-\alpha/2}^*(t), \tilde F_{nh}(t)-Z_{\alpha/2}^*(t)\right],\]</span> where <span class="math inline">\(Z_{\alpha}^*(t)\)</span> is the <span class="math inline">\(\alpha\)</span>th quantile of <span class="math inline">\(B\)</span> values of <span class="math inline">\(V_{nh}^*(t)\)</span> defined by, <span class="math display">\[V_{nh}^*(t)=\tilde F_{nh}^*(t)-\tilde F_{nh}(t),\]</span></p>
<p>Besides the upper and lower bounds of the <span class="math inline">\(1-\alpha\)</span> bootstrap confidence intervals, the function <em>ComputeConfIntervals</em> also returns the output of the functions <em>ComputeMLE</em> and <em>ComputeSMLE</em>. Since the limiting behavior for the MLE in <span class="citation">Groeneboom and Wellner (1992)</span> is derived for each point within the interval starting from the smallest observation <span class="math inline">\(T_i\)</span> such that <span class="math inline">\(\Delta_i=1\)</span> until the largest obsrvation <span class="math inline">\(T_j\)</span> such that <span class="math inline">\(\Delta_j=0\)</span>, it is recommend to limit the construction of pointwise confidence intervals to points within this interval.</p>
<p>The general approach for constructing the confidence intervals is the following: First decide upon the points where the confidence intervals need to be computed. If no particular interest in certain points is requested, it is recommended to consider a grid of points within the interval starting from the smallest observed time point <span class="math inline">\(t_i\)</span> for which <span class="math inline">\(\delta_i=1\)</span> until the largest observed time point <span class="math inline">\(t_j\)</span> for which <span class="math inline">\(\delta_j=0\)</span>. The function <em>ComputeConfIntervals</em> can also deal with positive values outside this interval but some numerical instability is to be expected.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mingrid&lt;-A[<span class="kw">min</span>(<span class="kw">which</span>(A[,<span class="dv">2</span>]&gt;<span class="dv">0</span>)),<span class="dv">1</span>]
maxgrid&lt;-A[<span class="kw">max</span>(<span class="kw">which</span>(A[,<span class="dv">2</span>]&lt;A[,<span class="dv">3</span>])),<span class="dv">1</span>]
grid&lt;-<span class="kw">seq</span>(mingrid,maxgrid ,<span class="dt">length=</span><span class="dv">200</span>)</code></pre></div>
<p>Next, select the bandwidth vector for estimating the SMLE <span class="math inline">\(\tilde F_{nh}(t)\)</span> for each point in the grid. If no pre-specified bandwidth value is preferred, a data-driven bandwidth vector can be obtained by the function <em>ComputeBW</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bw&lt;-<span class="kw">ComputeBW</span>(<span class="dt">data=</span>A, <span class="dt">x=</span>grid)</code></pre></div>
<pre><code>## The computations took    4.018   seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(grid, bw, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.7</span>),<span class="dt">ylab=</span><span class="st">&quot;bw&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAGACAMAAACTGUWNAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8QDhghAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ8klEQVR4nO2dYZuaOBRG2elMt+PuTG3ZWuv//6EroEg0YBJufCGe82EfmsV7I0eTyJhrdQAplboDzw4CxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIECMsYAKTqgE2IZbLwgQYyVgV1V/fe8PWz6c1tS8pWMkYHe8zrvhtd5vXj2tCXlLx0bAn8/343+3r5eW+uWnpzUhb+nYCPj9dhxv2oveN7x7WlPylo6RgK/NOLO7XOptc3jTmpK3dGwEdAP9Zbjfb949rYfh8j++q2WSR8Dw3/5ZGAEn8gxB2y+/PK1JeUsnyyTcjUBMwiFkWYZ2V55laAhZPoidj/ggdh+rWxF1d9Phz2fzeu9HnZpbEffgZpwYBIhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQcCFecU0UpOanygJZ0HlM3DIbQABZ4bX//A4Awg4gwAxCFCz7jnAqQz0+62qms16+03zHFazTXXNqyBnQ+ruy6+uXlC3VX5e3tKxEeBsye7+0WxV9VcpiMtbOjYCnKIEl9d97R194vLm5s5wk30wMhIwLMuxe/lxHPvbt8S3qjuYkTczgxXPwXONhwuiPH22EeAUpqmrtlzZ63EeaIqmbIcGHja3BXK94qz8//uQz0AOAX85VWoWXa6mFAHOENRNBaeKKYODtLx5KUbAcBLuPPRTsX8tuhABpcwBzjJ0v2lsHDV0WhY9BJWyCnI/iNXHubdV0hrZepdBixGgxupWhFMvaHdefW6rtoLxnLzZiH1hZ3ojPO3NuPOgH3pFY88P7of5iZJw8fmHC5wM54d3xPxESbj4/AjQggDbcAkdYA4QwyoIGhAg5hkFzBpLrAeiJxQw6+ZaZW3g+QSc15JJBoa3p426Y36iJFxMZgRkCBeTGQEZwkWlZg6wDxeXm1UQnwN6nkuA2avX7n3wVALMbucYzgTPJOCygJmZ3XIthICUQAhIy4mAbOECkzIH5AoXmpVVUKZw6wUBYp5EgPUNBLuwzyHA/BbaKeyc23rnGOYnSsLdS2a3bByGvaxq08MiYEZYBAQnQ0DmcHezMQfkDXc3XUGroP3GX/0hU97SSXgHdCU4xn4q2zpv6SQPQfvNeCGImHCVw4yIY4myRb5JkZQlTUDzJrB5B/QLiSrDV7/b+Fm+VO6mGO5ljX50/IlNNaCbV7+3XpDb6gvndD7Ddcq1rcJJ4e7mjn149InescdfL8hp9YZDQMoQdHyBX62D/PWCnFZ/OAQkTsK1u//XXy/IaR0JxxyQeqIzEvnrBTmtY+FYBUWfuD0lG1xYf70gp/W6r/FdLZOkT8I386q/XpBHwHTeapzQbnqCxT80mYRe29wL8tcLChqCnLbRy58wuaU/NJmU102KgPZeRFONrMdfLyhkEnaanCs+z8AlyOMMXHU87O53goBduwCqhyOLv15QwDLUbUJAyIndZT1e2OF7wF8v6P4HMbcJASEndi/w67HdXy+ovncr4qqtGoE5wHkHdGNK7cwCsbAKOj8kOHZ/tGtf3SNDS3y4JydSwOmPMS02fw94dtbxN+HAcWn2sGXLxIh66dwqBFS3y6LKM71enaR+l42vKYYG1iDAf/1vDHjWrrZ9jmO0z5WzQkVALhCAALNwfgPMAfN6F3X25HMYO82ss4mEXP+VCCiYFQsIeU8sn/UKqPwTw9pYrQDP9Q+7/7swECAGAWJWK4A54EF5J0KwCnpE3tJBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYKwHDykDdNprXwcGMvKVjJMDZkHopl/J1dB8ZAk7YCHC3ZPcbWP1VCuLylo6NALcoQX0edOrx+pYIOGEkwCnLsf1WdRu1+4MZeUvHRoBTmGa/abZwb98vB4MoK/4GTx4yCDg1TU8ECDiRYwjqmt4+rg7S8pZOjkm4a5peiyLgRIZlaGfj+HboD+bkLZ0cH8RaEc3c2x/MyFs6VrcinHpBTV3FduDvD9Lzlg4348QgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIECMlQBvvSCnNTFv6eTYptpvzXZaE/OWToaN2v3WbLc1MW/p2Ajw1wvyFDCIz1s6RgK89YI8JTzi85aOjQB/vSBPERvqBV2TQcCp6eWnpzU+b+nkGIK6prcPhqAAckzCXdPX70zCAWRYhvZlgliGBpDjg1hfJogPYvexuhXhrxdUcyviHtyMEyMTACdEAmxCzo6wgC4IEy3g2S+gC8JEC3j2C+iCMNECnv0CuiBMtIBnv4AuCBMt4NkvoAvCRAt49gvogjDRAp79ArogTLSAZ7+ALiwuEfhBgBgEiEGAGASIQYAYBIhBgBgEiEGAGASIQYAYBIixE+BsHBvfRRYYYeJ366f4/Xf/jdWkLgwjJHYhEjMBzvcVJ768GBhh4nfrJ9hv+q8MJ3XBiZDWhVisBDjf2J36+m5YhKnfrR/n+KI/PyypC06EtC5EYyXA+c761BfYwyJM/W79KLvqvb9oSV1wIiR1IR4zAcNdG1NbOMIiTP1u/RQXASldcCKkdiESKwHOvqWpTUxhETy/Wx8WpP/F9ZQuOBFSuxDJQgWcmqJfwIYCUrsQyVKHoK7J+7v1U1gOQYldiGSpk3DXFL0QnDkJH24F5F6LLnQZOvW79VP0j0hcht4oXM0QZP1BbOJ36ydjzP0gNlwFpXUhErtbEc52svFdZKERxn+3for28s3oghMhrQuRcDNODALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxJQmoNkTs99k39toR2kCmp0xdbO9cS2UJuCwe/nxzyNKDFhRnIDDNnt9DVPKE7DLv63IkuIE/Pn89yFFNqwoTkD95b/PFS2CihOw33w8qM6MEaUJ2B6XoN0m05VQmoDVgQAxCBCDADEIEIMAMQgQgwAxCBCDADEIEIMAMQgQgwAxCBCDADEIEIMAMQgQgwAxCBCDADEIEIMAMf8DurDsLl70SQUAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>The bandwidth vector obatined by the function <em>ComputeBW</em> is used as input bandwidth for the function <em>ComputeConfIntervals</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out&lt;-<span class="kw">ComputeConfIntervals</span>(<span class="dt">data=</span>A,<span class="dt">x=</span>grid,<span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">bw=</span>bw )</code></pre></div>
<pre><code>## The program produces the Studentized nonparametric bootstrap confidence intervals for the cdf, using the SMLE
## 
## For further information see:
## The nonparametric bootstrap for the current status model,
## Piet Groeneboom &amp; Kim Hendrickx, Electronical Journal of Statistics (2017).
## 
## Number of unique observations:   1000
## Sample size n = 1000
## Number of Studentized Intervals = 200
## Number of Non-Studentized Intervals = 0
## The computations took    4.172   seconds</code></pre>
<p>The function <em>ComputeConfIntervals</em> informs about the number of times the Studentized resp. classical bootstrap confidence intervals are calculated. The default method is the Studentized bootstrap confidence interval. In this simulated data example, the variance estimate for the Studentized confidence intervals is available for each point in the grid and out$Studentized equals grid.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(out)</code></pre></div>
<pre><code>## $names
## [1] &quot;MLE&quot;            &quot;SMLE&quot;           &quot;CI&quot;             &quot;Studentized&quot;   
## [5] &quot;NonStudentized&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$NonStudentized</code></pre></div>
<pre><code>## numeric(0)</code></pre>
<p>A picture of the the SMLE together with the pointwise confidence intervals in the gridpoints and the true distribution function <span class="math inline">\(F_0\)</span> is given below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">left&lt;-out$CI[,<span class="dv">1</span>]
right&lt;-out$CI[,<span class="dv">2</span>] 

<span class="kw">plot</span>(grid, out$SMLE,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, left, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">lines</span>(grid, right, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">segments</span>(grid,left, grid, right)
<span class="kw">lines</span>(grid, (<span class="dv">1</span>-<span class="kw">exp</span>(-grid))/(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="fl">2.0</span>)), <span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="data-applications" class="section level2">
<h2>Data applications</h2>
<div id="hepatitis-a-data" class="section level3">
<h3>Hepatitis A data</h3>
<p><span class="citation">Niels Keiding (1991)</span> considered a cross-sectional study on the Hepatitis A virus from Bulgaria. In 1964 samples were collected from schoolchildren and blood donors on the presence or absence of Hepatitis A immunity. In total <span class="math inline">\(n=850\)</span> individuals ranging from 1 to 86 years old were tested for immunization. It is assumed that, once infected with Hepatitis A, lifelong immunity is achieved. To estimate the sero-prevalence for Hepatitis A in Bulgaria 95% confidence intervals around the distribution function for the time to infection are computed using the <em>ComputeConfIntervals</em> function in the package <em>curstatCI</em>. Since only 51 out of the 850 individuals were older than 69 years, who, moreover, all had antibodies for Hepatitis A, it seems sensible to restrict the range to [0,69]. The resulting confidence intervals are obtained as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(hepatitisA)
mingrid&lt;-hepatitisA[<span class="kw">min</span>(<span class="kw">which</span>(hepatitisA$freq1&gt;<span class="dv">0</span>)),<span class="dv">1</span>]
maxgrid&lt;-hepatitisA[<span class="kw">max</span>(<span class="kw">which</span>(hepatitisA$freq1&lt;hepatitisA$freq2)),<span class="dv">1</span>]
<span class="kw">c</span>(mingrid, maxgrid)</code></pre></div>
<pre><code>## [1]  1 69</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid&lt;-mingrid:maxgrid

bw&lt;-<span class="kw">ComputeBW</span>(<span class="dt">data=</span>hepatitisA,<span class="dt">x=</span>grid)
out&lt;-<span class="kw">ComputeConfIntervals</span>(<span class="dt">data=</span>hepatitisA,<span class="dt">x=</span>grid,<span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">bw=</span>bw)</code></pre></div>
<p>The estimated prevalence of Hepatitis A at the age of 18 is 0.51, about half of the infections in Bulgaria happen during childhood.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$SMLE[<span class="dv">18</span>]</code></pre></div>
<pre><code>## [1] 0.5109369</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">left&lt;-out$CI[,<span class="dv">1</span>]
right&lt;-out$CI[,<span class="dv">2</span>]

<span class="kw">plot</span>(grid, out$SMLE,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, left, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">lines</span>(grid, right, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">segments</span>(grid,left, grid, right)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> The confidence interval around <span class="math inline">\(\tilde F_{nh}(1)\)</span> is computed using the classical confidence interval instead of the Studentized confidence interval.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out$NonStudentized</code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="rubella" class="section level3">
<h3>Rubella</h3>
<p><span class="citation">N. Keiding et al. (1996)</span> considered a current status data set on the prevalence of rubella in 230 Austrian males with ages ranging from three months up to 80 years. Rubella is a highly contagious childhood disease spread by airborne and droplet transmission. The symptoms (such as rash, sore throat, mild fever and swollen glands) are less severe in children than in adults. Since the Austrian vaccination policy against rubella only vaccinated girls, the male individuals included in the data set represent an unvaccinated population and (lifelong) immunity could only be acquired if the individual got the disease. Pointwise confidence intervals are useful to investigate the time to immunization (i.e.the time to infection) against rubella.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(rubella)
mingrid&lt;-rubella[<span class="kw">min</span>(<span class="kw">which</span>(rubella$freq1&gt;<span class="dv">0</span>)),<span class="dv">1</span>]
maxgrid&lt;-rubella[<span class="kw">max</span>(<span class="kw">which</span>(rubella$freq1&lt;rubella$freq2)),<span class="dv">1</span>]
<span class="kw">c</span>(mingrid, maxgrid)</code></pre></div>
<pre><code>## [1]  0.9452 74.4658</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid&lt;-<span class="dv">1</span>:<span class="dv">74</span>
bw&lt;-<span class="kw">ComputeBW</span>(<span class="dt">data=</span>rubella,<span class="dt">x=</span>grid)
out&lt;-<span class="kw">ComputeConfIntervals</span>(<span class="dt">data=</span>rubella,<span class="dt">x=</span>grid,<span class="dt">alpha=</span><span class="fl">0.05</span>, <span class="dt">bw=</span>bw)</code></pre></div>
<p>The SMLE increases steeply in the ages before adulthood which is in line with the fact that rubella is considered as a childhood disease.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">left&lt;-out$CI[,<span class="dv">1</span>]
right&lt;-out$CI[,<span class="dv">2</span>]

<span class="kw">plot</span>(grid, out$SMLE,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, left, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">lines</span>(grid, right, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">segments</span>(grid,left, grid, right)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="exponential-sample" class="section level3">
<h3>Exponential sample</h3>
<p>In this example, 1000 observations are simulated from the exponential distribution with mean 4/3. Although the theory does not support this data model, <em>curstatCI</em> can still be used to construct confidence intervals around the SMLE of the exponential distributuin function <span class="math inline">\(F_0(t)=1-\exp(-0.75t)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># sample size</span>
n&lt;-<span class="dv">1000</span>

<span class="co"># Exponential Data without ties (mean 1/lambda)</span>
<span class="kw">set.seed</span>(<span class="dv">100</span>)
lambda&lt;-<span class="fl">0.75</span>;
y&lt;-<span class="kw">rexp</span>(n,lambda); <span class="kw">summary</span>(y)</code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##  0.000013  0.378998  0.897876  1.295308  1.668536 10.990436</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t&lt;-<span class="kw">runif</span>(n, <span class="dv">0</span>,<span class="dv">5</span>)
delta&lt;-<span class="kw">as.numeric</span>(y&lt;=t)

## input data matrix
A&lt;-<span class="kw">cbind</span>(t[<span class="kw">order</span>(t)], delta[<span class="kw">order</span>(t)], <span class="kw">rep</span>(<span class="dv">1</span>,n))


## x vector (recommended)
maxgrid&lt;-A[<span class="kw">max</span>(<span class="kw">which</span>(A[, <span class="dv">2</span>]==<span class="dv">0</span>)),<span class="dv">1</span>]
mingrid&lt;-A[<span class="kw">min</span>(<span class="kw">which</span>(A[, <span class="dv">2</span>]==<span class="dv">1</span>)),<span class="dv">1</span>]
<span class="kw">c</span>(mingrid,maxgrid)</code></pre></div>
<pre><code>## [1] 0.08059889 4.69135652</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## x vector 2
grid&lt;-<span class="kw">seq</span>(A[<span class="dv">2</span>,<span class="dv">1</span>] ,A[n<span class="dv">-1</span>,<span class="dv">1</span>], <span class="dt">length=</span><span class="dv">200</span>)
<span class="kw">c</span>(A[<span class="dv">2</span>,<span class="dv">1</span>] ,A[n<span class="dv">-1</span>,<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] 0.006832762 4.990860837</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bw&lt;-<span class="kw">ComputeBW</span>(A,grid)</code></pre></div>
<pre><code>## The computations took    4.181   seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(grid,bw,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out=<span class="kw">ComputeConfIntervals</span>(A,grid,<span class="fl">0.05</span>, bw)</code></pre></div>
<pre><code>## The program produces the Studentized nonparametric bootstrap confidence intervals for the cdf, using the SMLE
## 
## For further information see:
## The nonparametric bootstrap for the current status model,
## Piet Groeneboom &amp; Kim Hendrickx, Electronical Journal of Statistics (2017).
## 
## Number of unique observations:   1000
## Sample size n = 1000
## Number of Studentized Intervals = 200
## Number of Non-Studentized Intervals = 0
## The computations took    3.97   seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">left&lt;-out$CI[,<span class="dv">1</span>]
right&lt;-out$CI[,<span class="dv">2</span>]</code></pre></div>
<p>The confidence intervals at the points outside the recommended range do not include the true distribution function is this example. The overall performance of the confidence intervals is good despite the fact that the theory for this model is not yet proven.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(grid, out$SMLE,<span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, left, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">lines</span>(grid, right, <span class="dt">col=</span><span class="dv">4</span>)
<span class="kw">segments</span>(grid,left,grid,right)

## True distribution function
<span class="kw">lines</span>(grid, <span class="dv">1</span>-<span class="kw">exp</span>(-lambda*grid), <span class="dt">col=</span><span class="dv">2</span>)

## Recommended x limits
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(mingrid, maxgrid), <span class="dt">col=</span><span class="dv">2</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> ## References</p>
<div id="refs" class="references">
<div id="ref-GroeneboomHendrickx2017">
<p>Groeneboom, P., and K. Hendrickx. 2017. The Nonparametric Bootstrap for the Current Status Model. Submitted. <a href="\url{https://arxiv.org/abs/1701.07359}" class="uri">\url{https://arxiv.org/abs/1701.07359}</a>.</p>
</div>
<div id="ref-GrWe92">
<p>Groeneboom, P., and J.A. Wellner. 1992. <em>Information Bounds and Nonparametric Maximum Likelihood Estimation</em>. Vol. 19. DMV Seminar. Basel: Birkhuser Verlag.</p>
</div>
<div id="ref-Keiding96">
<p>Keiding, N., K. Begtrup, T.H. Scheike, and G. Hasibeder. 1996. Estimation from Current Status Data in Continuous Time. <em>Lifetime Data Anal.</em> 2: 11929.</p>
</div>
<div id="ref-Keiding91">
<p>Keiding, Niels. 1991. Age-Specific Incidence and Prevalence: A Statistical Perspective. <em>J. Roy. Statist. Soc. Ser. A</em> 154 (3): 371412. doi:<a href="https://doi.org/10.2307/2983150">10.2307/2983150</a>.</p>
</div>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
