<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Piet Groeneboom and Kim Hendrickx" />

<meta name="date" content="2017-07-13" />

<title>Confidence intervals with current status data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Confidence intervals with current status data</h1>
<h4 class="author"><em>Piet Groeneboom and Kim Hendrickx</em></h4>
<h4 class="date"><em>2017-07-13</em></h4>



<p>In the current status model, the variable of interest <span class="math inline">\(X\)</span> with distribution function <span class="math inline">\(F_0\)</span> is not observed directly. A censoring variable <span class="math inline">\(T \sim G\)</span> is observed instead together with the indicator <span class="math inline">\(\Delta = (X \le T)\)</span>. <em>curstatCI</em> provides functions to estimate the distribution function <span class="math inline">\(F_0\)</span> and to construct pointswise confidence intervals around <span class="math inline">\(F_0(t)\)</span> based on an observed sample <span class="math inline">\((T_1, \Delta_1),\ldots, (T_n, \Delta_n)\)</span> of size <span class="math inline">\(n\)</span> from the observable random vector <span class="math inline">\((T, \Delta)\)</span>.</p>
<p>To illustrate the usage of the functions provided in the <em>curstatCI</em> package we consider a sample <span class="math inline">\((X_1,\ldots,X_n)\)</span> of size <span class="math inline">\(n=1000\)</span> from the truncated exponential distribution on <span class="math inline">\([0,2]\)</span> with distribution function <span class="math inline">\(F_0(t) = (1-\exp(-t))/(1-\exp(-2)\)</span> if <span class="math inline">\(t \in [0,2]\)</span>. The observation points <span class="math inline">\((T_1,\ldots,T_n)\)</span> are uniformly distribution on <span class="math inline">\([0,2]\)</span>. This data setting is also considered in the simulation section of <span class="citation">(Groeneboom and Hendrickx 2017)</span>. The R-code to generate the observable random vector <span class="math inline">\((t_1,\delta_1), \ldots, (t_n, \delta_n)\)</span> is given below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)

n&lt;-<span class="dv">1000</span>
t &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n)
delta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n)

for(i in (<span class="dv">1</span>:n) ){
  x&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)
  y&lt;--<span class="kw">log</span>(<span class="dv">1</span>-(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="dv">2</span>))*x)
  t[i]&lt;-<span class="dv">2</span>*<span class="kw">runif</span>(<span class="dv">1</span>);
  if(y&lt;=t[i]){ delta[i]&lt;-<span class="dv">1</span>}
  else{delta[i]&lt;-<span class="dv">0</span>}}</code></pre></div>
<div id="the-nonparametric-maximum-likelihood-estimator-mle" class="section level2">
<h2>The nonparametric maximum likelihood estimator (MLE)</h2>
<p>The MLE <span class="math inline">\(F_n\)</span> of <span class="math inline">\(F_0\)</span> is defined as the maximizer of the loglikelihood given by (up to a constant not depending on <span class="math inline">\(F\)</span>) <span class="math display">\[ \sum_{i=1}^n \Delta_i\log F(T_i) +  (1-\Delta_i)\log(1-F(T_i)),\]</span> over all possible distribution functions <span class="math inline">\(F\)</span>. As can be seen from its structure, the loglikelihood only depends on the value that <span class="math inline">\(F\)</span> takes at the observed times points <span class="math inline">\(T_i\)</span>. The values in between are irrelevant as long as <span class="math inline">\(F\)</span> is increasing. The MLE <span class="math inline">\(F_n\)</span> is a step function which can be characterized by the left derivative of the greatest convex minorant of the cumulative sumdiagran consisting of the points <span class="math inline">\(P_0 = (0,0)\)</span> and <span class="math display">\[P_i = \left(\sum_{j=1}^i w_j,\sum_{j=1}^i f_{1j}\right),\,i=1,\dots,m,\]</span></p>
<p>where the <span class="math inline">\(w_j\)</span> are weights, given by the number of observations at point <span class="math inline">\(T_{(j)}\)</span>, assuming that <span class="math inline">\(T_{(1)}&lt;\dots&lt;T_{(m)}\)</span> (<span class="math inline">\(m\)</span> being the number of different observations in the sample) are the order statistics of the sample <span class="math inline">\((T_1,\Delta_1),\dots,(T_n,\Delta_n)\)</span> and where <span class="math inline">\(f_{1j}\)</span> is the number of <span class="math inline">\(\Delta_k\)</span> equal to one at the <span class="math inline">\(j\)</span>th order statistic of the sample. When no ties are present in the data, <span class="math inline">\(w_j =1, m =n\)</span> and <span class="math inline">\(f_{1j} = \Delta_{(j)}\)</span>, where <span class="math inline">\(\Delta_{(j)}\)</span> corresponds to <span class="math inline">\(T_{(j)}\)</span>.</p>
<p>The function <em>ComputeMLE</em> in the package curstatCI computes the values of the MLE at the distictinct jumppoints of the stepwise MLE. The current status data needs to be formatted as follows. The first column contains the observations <span class="math inline">\(t_{(1)}&lt;\dots&lt;t_{(m)}\)</span> in ascending order. The second and third columns contain the variables <span class="math inline">\(f_{1j}\)</span> and <span class="math inline">\(w_j\)</span> corresponding to <span class="math inline">\(t_{(j)}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A&lt;-<span class="kw">cbind</span>(t[<span class="kw">order</span>(t)], delta[<span class="kw">order</span>(t)], <span class="kw">rep</span>(<span class="dv">1</span>,n))
<span class="kw">head</span>(A)</code></pre></div>
<pre><code>##              [,1] [,2] [,3]
## [1,] 0.0007901406    0    1
## [2,] 0.0064286250    0    1
## [3,] 0.0075551583    0    1
## [4,] 0.0121238651    0    1
## [5,] 0.0150197768    0    1
## [6,] 0.0179643347    0    1</code></pre>
<p>The function <em>ComputeMLE</em> returns the jumppoints and corresponding values of the MLE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp)
<span class="kw">library</span>(curstatCI)

mle&lt;-<span class="kw">ComputeMLE</span>(<span class="dt">data=</span>A)
mle</code></pre></div>
<pre><code>##             x        mle
## 1  0.00000000 0.00000000
## 2  0.04461921 0.05405405
## 3  0.12463964 0.15000000
## 4  0.18832966 0.18181818
## 5  0.21623244 0.21428571
## 6  0.24208302 0.25000000
## 7  0.25054101 0.30555556
## 8  0.32536475 0.38461538
## 9  0.34771374 0.38888889
## 10 0.39735814 0.45454545
## 11 0.55754520 0.50000000
## 12 0.63327266 0.51515152
## 13 0.70567068 0.54838710
## 14 0.74357757 0.61363636
## 15 0.82979603 0.66666667
## 16 0.83427289 0.69230769
## 17 0.90577147 0.69902913
## 18 1.13136189 0.75000000
## 19 1.14422337 0.81967213
## 20 1.38870142 0.85714286
## 21 1.40659256 0.90000000
## 22 1.48428796 0.92307692
## 23 1.55291452 0.97297297
## 24 1.77735579 0.98666667
## 25 1.91620524 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mle$x, mle$mle,<span class="dt">type =</span><span class="st">'s'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">main=</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="the-smoothed-maximum-likelihood-estimator-smle" class="section level2">
<h2>The smoothed maximum likelihood estimator (SMLE)</h2>
<p>Starting from the nonparametric MLE <span class="math inline">\(F_n\)</span>, a smooth estimator <span class="math inline">\(\tilde{F}_{nh}\)</span> of the distribution function <span class="math inline">\(F_0\)</span> can be obtained by smoothing the MLE <span class="math inline">\(F_n\)</span> using a kernel function <span class="math inline">\(K\)</span> and bandwidth <span class="math inline">\(h&gt;0\)</span>. We use the triweight kernel defined by <span class="math display">\[ K(t)=\frac{35}{32}\left(1-t^2\right)^31_{[-1,1]}(t).\]</span> The SMLE is next defined by <span class="math display">\[ \tilde F_{nh}(t)=\int\mathbb K\left(\frac{t-x}{h}\right)\,d F_n(x), \]</span> where <span class="math display">\[\mathbb K(t) = \int_{-\infty}^t K(x)\,dx.\]</span> The function <em>ComputeSMLE</em> computes the values of the SMLE in the points x based on a prespecified bandwidth choice <span class="math inline">\(h\)</span>. The same bandwidth <span class="math inline">\(h\)</span> is used for all points in x. A data-driven (and possbily different) bandwidth choice for each point in x is considered in the function <em>ComputeConfIntervals</em> which is described later. For our simulated data set, a picture of the SMLE <span class="math inline">\(\tilde F_{nh}(t)\)</span> using a bandwidth <span class="math inline">\(h=2n^{-1/5}\)</span>, evaluated in the points <span class="math inline">\(t=0,0.02,0.04,\ldots,2\)</span> together with true distribution function <span class="math inline">\(F_0\)</span> is obtained as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>, <span class="fl">0.02</span>)
smle &lt;-<span class="kw">ComputeSMLE</span>(<span class="dt">data=</span>A, <span class="dt">x=</span>grid, <span class="dt">h=</span><span class="dv">2</span>*n^-<span class="fl">0.2</span>)
<span class="kw">plot</span>(grid, smle,<span class="dt">type =</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, (<span class="dv">1</span>-<span class="kw">exp</span>(-grid))/(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="fl">2.0</span>)), <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lty =</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////AAD/tmb/25D//7b//9v///808XmoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHaElEQVR4nO2dbZuaOhCG6cuenrV7ausRXf7/Hy0QVKKEJyQzZNDn/tBrlTjBuyQhE8CqIbNUpXfAOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBAv6PTjz+XPuqq+/JoOtxnEBZ13Xy+C6tZOPW1oMwekuKD2oLkI+vx4b//df8+qtzTSgurqvb4IOr39bP89XA+opHpLI9/Empugf36NX/ZRFjftYgy7qCnIdT/TnZBZQf3/3rFjeB39wegqtiqoGtzcvRv98eiK5ppYQrg1uDT6470eZUHb6KQvbgJbo8NEV1hvZ5i/DhchPbqCzJ8oBlrVQ5noYHH0gj4/ugPnEJ5qRIfTYmhZsFh0vKy90Q63tPbODjp2hqLRMTP2Rz9cQuUxdpqXFNSfB8aXFi9YJFx8vV3bWvQB8YJFwsWy5NhxvJSgaqmd5pUEHdMyCC8iqG1aiTVqZBRv54btiWL1M69eGdKrE88ojmcXh+7FtKH1BHUHT0ZtwoK8+ambbhSerB4z6xIW5GU4igvqx/TM7K60IC9HVriJCegRF3SXZX1YOFwzad/7yY6iKmjfHkmnt/esetMYGpdALZpNrFzKVaRxOTQ76WKrGjKNy6E5zDtbRVY15Po41RPF9fugYbYuGF18qjGkoYdzoLafnPSjJGjomiWDP91kVTrwEwkSHLpGPI2go+TQNeJZBOkcPs3zCNIJuSSqYUESk/YgTyBIU88zCDrKTEpDbF+Q8qxFN2l/equqyYSi0Lc6HhUbl0N1LlZ/+78579RSrsfcfHMMukn77oVaPkjpzPAOzXyQy55l1iuwU+tUkZBRrL/+3mnN5nXH9hGaOelDd9eGy3tco8gk7bUmXhOoCvqidJ30aodPo9vEXFfkuqXkerN2RwDVpL0TNNlVZy53rre0rznMn3caSfvu5DD5w8vRvbqjPVF0ytLrvUf/3NlHN2lfiyft1z18mu1NVle/E29TgrKuhEpkQ4KSLzPMYjuCVu99HNsRtH7342oVL6gVroiezQgq0T07tiGoSPfs2ISgxXegCKKbtG/Zt9ONnHqbku2rUZ6Lda+rbEFlH2OhOZtvugl9tqCienTzQd1f3/7LFFSw++nRzCj2L/0+aHFOuuD45dDMSfcNLq+TLn38KAvqEmZZgsr7UW1i/YssQaXb15JdSOikD0N3k7yqYcCP9jCfcwQV7597tE8U0wXZ8KOctG/SBRnxY3ayasWPWUFW/FgVZOc5iyYFlcz/3GNRkJn+p8OgIFN+LAoy5YeCEKo56c+PhKs7bPlRnWp8frR/HKYvtQ+GM+ZHdbKa8mABQwO8Qzkn3Sx8sICtEaxDNyfdsV9wBNnzo5ty7d/xeun5pL1BP+qC6iW3Qxn0o93E6sAo/7qC/E76EPIzFc5iA1POSR8CzwicDGfTj+qJYuDBL9PhjPpRzUkPyz5R50FW/ZiZrFr1Q0EII4LM+jEiyK4fG4LMTeFHWBBkdgTrMCFINrQsBgSZ9mNAkOX21Sgn7ed+RnT5HpRB9fqgmF+Hst3AdGfzMb8vZt2Paj4oYlXDvB/9q1xnf0bUvh/VnPTGfiVzGgoCrNzEltdbmsKdtH2KDfObQVZQ9InioqCx5YoUW1rcu5A8/DOiy4I+kyCVoBQkU46CLBZLLC4blIJkylGQxWKJxWWDvqygZ4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBJAVFXkPkbTrvujWY6XurmtOPP1OfCRcLR/NvRJ6LdoegoNilIW/T3A8FnXe3+69mVppGxYLR/BuR4brVCDlBsYuL/qbpFWy3qaouG+fWKkfFwtG81eC5aA/ICYpdnvY3HYK7WVfvtwc3hsONi81Ec2XdUTO3dv6AoKDICxz8Tft/q9BDCvwnW4bCee/PRrveiDwf7Q45QbGXyHibzrvuUV/7wHe6foe5K25GxeajXW8knY92R2FBw1vo0IgUBKKN++gCgtKamHtr8pemEprYXLTbjciFmlhaJ+3eCozOMZ108yhoMtroRuRCnXTSMO/2FR4a8wPzncfJaOMbkQsN82kniv1uwk56/tRuNIqFovk3Ipc5UYy/hsgrt6+mnwrb0X9zfEnSqFgo2vVG5LgLnEZwsgqgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgLys+C+8l7+aHAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="pointwise-confidence-intervals-around-the-smle" class="section level2">
<h2>Pointwise confidence intervals around the SMLE</h2>
<p>The nonparametric bootstrap procedure, which consists of resampling (with replacement) the <span class="math inline">\((T_i,\Delta_i)\)</span> from the original sample is consistent for generating the limiting distribution of the SMLE <span class="math inline">\(\tilde F_{nh}(t)\)</span> under current status data. (see <span class="citation">Groeneboom and Hendrickx (2017)</span>). This implies that valid pointwise confidence intervals for the distribution function <span class="math inline">\(F_0(t)\)</span> can be constructed using a bootstrap sample <span class="math inline">\((T_1^*,\Delta_1^*),\ldots (T_n^*,\Delta_n^*)\)</span>. The <span class="math inline">\(1-\alpha\)</span> bootstrap confidence intervals generated by the function <em>ComputeConfIntervals</em> are given by <span class="math display">\[ \left[\tilde F_{nh}(t)-Q_{1-\alpha/2}^*(t)\sqrt{S_{nh}(t)}, \tilde F_{nh}(t)-Q_{\alpha/2}^*(t)\sqrt{S_{nh}(t)}\right],\]</span> where <span class="math inline">\(Q_{\alpha}^*(t)\)</span> is the <span class="math inline">\(\alpha\)</span>th quantile of <span class="math inline">\(B\)</span> values of <span class="math inline">\(W_{nh}^*(t)\)</span> defined by, <span class="math display">\[W_{nh}^*(t)=\left\{\tilde F_{nh}^*(t)-\tilde F_{nh}(t)\right\}/\sqrt{S_{nh}^*(t)},\]</span> where <span class="math inline">\(\tilde F_{nh}^*(t)\)</span> is the SMLE in the bootstrap sample and <span class="math inline">\(S_{nh}(t)\)</span> is given by: <span class="math display">\[S_{nh}(t)=\frac1{hn^{2}}\sum_{i=1}^n K\left(\frac{t-T_i}h\right)^2\left(\Delta_i-F_n(T_i)\right)^2.\]</span> <span class="math inline">\(S_{nh}(t)^*\)</span> is the bootstrap analogue of <span class="math inline">\(S_{nh}(t)\)</span> obtained by replacing <span class="math inline">\((T_i,\Delta_i)\)</span> in the expression above by <span class="math inline">\((T_i^*,\Delta_i^*)\)</span>. The number of bootstrap samples <span class="math inline">\(B\)</span> used by the function <em>ComputeSMLE</em> equals <span class="math inline">\(b=1000\)</span> and the bandwidth used for estimating the SMLE <span class="math inline">\(\tilde F_{nh}\)</span> at point <span class="math inline">\(t\)</span> is obtained by minimizing the pointwise Mean Squared Error using the subsampling pricinciple in combination with undersmoothing as described in Sections 4.1.2 and 4.1.3 of <span class="citation">Groeneboom and Hendrickx (2017)</span>. Besides the upper and lower bound of the <span class="math inline">\(1-\alpha\)</span> bootstrap confidence intervals, the function <em>ComputeConfIntervals`</em> also returns the data driven pointwise bandwidth choices and the corresponding output of the functions <em>ComputeMLE</em> and <em>ComputeSMLE</em> (using the data-driven bandwith).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out=<span class="kw">ComputeConfIntervals</span>(<span class="dt">data=</span>A,<span class="dt">x=</span>grid,<span class="dt">alpha=</span><span class="fl">0.05</span>)</code></pre></div>
<pre><code>## 
## Piet Groeneboom and Kim Hendrickx 2017
## For further information see:
## The nonparametric bootstrap for the current status model,
## Piet Groeneboom &amp; Kim hendricx, Electronical Journal of Statistics (2017).
## 
## The program produces the Studentized nonparametric bootstrap confidence intervals for the cdf, using the SMLE
## 
## 
## Number of unique observations:   1000
## 
## Sample size N = 1000
## 
## 
## The computations took    3.594   seconds</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">left&lt;-out$CI[,<span class="dv">1</span>]
right&lt;-out$CI[,<span class="dv">2</span>]

<span class="kw">plot</span>(grid, out$SMLE,<span class="dt">type =</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">main=</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">lines</span>(grid, left, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(grid, right, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">segments</span>(grid,left, grid, right)
<span class="kw">lines</span>(grid, (<span class="dv">1</span>-<span class="kw">exp</span>(-grid))/(<span class="dv">1</span>-<span class="kw">exp</span>(-<span class="fl">2.0</span>)), <span class="dt">col =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div id="refs" class="references">
<div id="ref-GroeneboomHendrickx2017">
<p>Groeneboom, Piet, and Kim Hendrickx. 2017. “The Nonparametric Bootstrap for the Current Status Model.” <a href="https://arxiv.org/abs/1701.07359" class="uri">https://arxiv.org/abs/1701.07359</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
